{% extends "dashboard/base_dashboard.html" %}
{% block dash_content %}

<div class="container-fluid px-0">

  <!-- HEADER -->
  <div class="tg-section-header mt-2 mb-4">
    <h3 class="fw-bold text-accent mb-0">
      <i class="fa-solid fa-hotel me-2"></i>
      Hospitality Security Dashboard
    </h3>
    <p class="text-muted small">
      Visibility into guest Wi-Fi, POS systems, and front-desk endpoints across properties.
    </p>
  </div>

  <!-- METRIC CARDS -->
  <div class="row g-3">

    <div class="col-md-3">
      <div class="tg-metric-card">
        <div class="label">Total Devices</div>
        <div id="metric-total-devices" class="value">—</div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="tg-metric-card">
        <div class="label">Online</div>
        <div id="metric-online-devices" class="value text-success">—</div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="tg-metric-card">
        <div class="label">Offline</div>
        <div id="metric-offline-devices" class="value text-danger">—</div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="tg-metric-card">
        <div class="label">Events (last 24h)</div>
        <div id="metric-last24-events" class="value text-info">—</div>
      </div>
    </div>
  </div>

  <!-- FAILED LOGINS + TREND BADGE -->
  <div class="row g-3 mt-1">
    <div class="col-md-3">
      <div class="tg-metric-card">
        <div class="label">Failed Logins (24h)</div>
        <div id="metric-failed-logins" class="value text-warning">—</div>
        <span id="trend-badge" class="trend-badge">
          Loading trend…
        </span>
      </div>
    </div>
  </div>

  <!-- GRAPH PANELS -->
  <div class="row g-4 mt-2">

    <div class="col-md-12">
      <div class="tg-panel">
        <div class="panel-header">
          <span><i class="fa-solid fa-chart-line me-2 text-warning"></i>Failed Login Trend (last 24h)</span>
          <span class="text-muted small">Grouped by hour</span>
        </div>
        <div class="panel-body">
          <canvas id="chart-failed-logins"></canvas>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="tg-panel">
        <div class="panel-header">
          <span><i class="fa-solid fa-signal me-2 text-accent"></i>Events by Severity (24h)</span>
        </div>
        <div class="panel-body">
          <canvas id="chart-severity"></canvas>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="tg-panel">
        <div class="panel-header">
          <span><i class="fa-solid fa-desktop me-2 text-success"></i>Devices by OS (top devices)</span>
          <span class="text-muted small">Based on active devices</span>
        </div>
        <div class="panel-body">
          <canvas id="chart-os"></canvas>
        </div>
      </div>
    </div>
  </div>

  <!-- TABLES -->
  <div class="row g-4 mt-1">

    <div class="col-md-6">
      <div class="tg-panel">
        <div class="panel-header">
          <span><i class="fa-solid fa-list-check me-2 text-info"></i>Top Devices (by events)</span>
        </div>
        <div class="panel-body table-responsive">
          <table class="table table-dark table-striped table-hover table-sm align-middle mb-0">
            <thead>
              <tr>
                <th>Device</th>
                <th>Events</th>
                <th>OS</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody id="top-devices-body">
              <tr>
                <td colspan="4" class="text-muted small text-center">
                  Loading devices…
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="tg-panel">
        <div class="panel-header">
          <span><i class="fa-solid fa-clock-rotate-left me-2 text-purple"></i>Latest Security Events</span>
          <span class="text-muted small">Most recent 10</span>
        </div>
        <div class="panel-body table-responsive">
          <table class="table table-dark table-hover table-sm align-middle mb-0">
            <thead>
              <tr>
                <th>Time</th>
                <th>Severity</th>
                <th>Category</th>
                <th>Detail</th>
              </tr>
            </thead>
            <tbody id="latest-events-body">
              <tr>
                <td colspan="4" class="text-muted small text-center">
                  Loading events…
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

  </div>

</div>

{% endblock %}
